<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netlify Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .loading { background: #fff3cd; border-color: #ffeaa7; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üß™ Netlify Compatibility Test</h1>
    
    <div id="csv-test" class="test loading">
        <h3>üìä Google Sheets CSV Test</h3>
        <p>Testing: <code>https://docs.google.com/spreadsheets/d/1lMES8jWfpUPoJNVL1O3QqzdpCSQMtfAbDq-r-xsNTJc/export?format=csv&gid=0</code></p>
        <div id="csv-result">Loading...</div>
    </div>

    <div id="github-test" class="test loading">
        <h3>üêô GitHub API Test</h3>
        <p>Testing: <code>https://api.github.com/repos/nishamehndidesigner/gallery/contents</code></p>
        <div id="github-result">Loading...</div>
    </div>

    <div id="image-test" class="test loading">
        <h3>üñºÔ∏è GitHub Raw Image Test</h3>
        <p>Testing: <code>https://raw.githubusercontent.com/nishamehndidesigner/gallery/main/simple_1.jpg</code></p>
        <div id="image-result">Loading...</div>
    </div>

    <script>
        // Test Google Sheets CSV
        async function testCSV() {
            const csvTest = document.getElementById('csv-test');
            const csvResult = document.getElementById('csv-result');
            
            try {
                const response = await fetch('https://docs.google.com/spreadsheets/d/1lMES8jWfpUPoJNVL1O3QqzdpCSQMtfAbDq-r-xsNTJc/export?format=csv&gid=0');
                const csvText = await response.text();
                
                if (csvText && csvText.length > 0) {
                    csvTest.className = 'test success';
                    csvResult.innerHTML = `
                        <p>‚úÖ <strong>SUCCESS</strong> - CSV loaded (${csvText.length} characters)</p>
                        <pre>${csvText.substring(0, 200)}...</pre>
                    `;
                } else {
                    throw new Error('Empty CSV response');
                }
            } catch (error) {
                csvTest.className = 'test error';
                csvResult.innerHTML = `
                    <p>‚ùå <strong>FAILED</strong> - ${error.message}</p>
                    <p>Make sure Google Sheet is PUBLIC: Share > Anyone with link > Viewer</p>
                `;
            }
        }

        // Test GitHub API
        async function testGitHub() {
            const githubTest = document.getElementById('github-test');
            const githubResult = document.getElementById('github-result');
            
            try {
                const response = await fetch('https://api.github.com/repos/nishamehndidesigner/gallery/contents');
                const files = await response.json();
                
                if (Array.isArray(files) && files.length > 0) {
                    const imageFiles = files.filter(f => /\.(jpg|jpeg|png|gif|webp)$/i.test(f.name));
                    githubTest.className = 'test success';
                    githubResult.innerHTML = `
                        <p>‚úÖ <strong>SUCCESS</strong> - Found ${files.length} files, ${imageFiles.length} images</p>
                        <pre>${JSON.stringify(imageFiles.map(f => f.name), null, 2)}</pre>
                    `;
                } else {
                    throw new Error('No files found or invalid response');
                }
            } catch (error) {
                githubTest.className = 'test error';
                githubResult.innerHTML = `
                    <p>‚ùå <strong>FAILED</strong> - ${error.message}</p>
                    <p>Check if repository exists and is public</p>
                `;
            }
        }

        // Test Image Loading
        async function testImage() {
            const imageTest = document.getElementById('image-test');
            const imageResult = document.getElementById('image-result');
            
            const img = new Image();
            const imageUrl = 'https://raw.githubusercontent.com/nishamehndidesigner/gallery/main/simple_1.jpg';
            
            img.onload = () => {
                imageTest.className = 'test success';
                imageResult.innerHTML = `
                    <p>‚úÖ <strong>SUCCESS</strong> - Image loaded (${img.width}x${img.height})</p>
                    <img src="${imageUrl}" style="max-width: 200px; border-radius: 8px;">
                `;
            };
            
            img.onerror = () => {
                imageTest.className = 'test error';
                imageResult.innerHTML = `
                    <p>‚ùå <strong>FAILED</strong> - Image not found</p>
                    <p>Upload simple_1.jpg to the repository</p>
                `;
            };
            
            img.src = imageUrl;
        }

        // Run all tests
        document.addEventListener('DOMContentLoaded', () => {
            testCSV();
            testGitHub();
            testImage();
        });
    </script>
</body>
</html>